<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metajam">
<title>Use Case 2 - Processing a Single Dataset from DataOne • metajam</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use Case 2 - Processing a Single Dataset from DataOne">
<meta property="og:description" content="metajam">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metajam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/use01_dataset-single-arctic.html">Use Case 1 - Processing a Single Dataset from Arctic Data Center</a>
    <a class="dropdown-item" href="../articles/use02_dataset-single-dataone.html">Use Case 2 - Processing a Single Dataset from DataOne</a>
    <a class="dropdown-item" href="../articles/use03_dataset-batch-processing.html">Use Case 3 - Processing Several Datasets</a>
    <a class="dropdown-item" href="../articles/use04_reading-raster.html">Use Case 4 - Processing a Raster Dataset</a>
    <a class="dropdown-item" href="../articles/use05_package-download.html">Use Case 5 - Downloading Entire Data Packages Using DOIs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nceas/metajam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Use Case 2 - Processing a Single Dataset from DataOne</h1>
                        <h4 data-toc-skip class="author">Julien Brun and
Kristen Peach, NCEAS</h4>
            
            <h4 data-toc-skip class="date">2024-07-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nceas/metajam/blob/HEAD/vignettes/use02_dataset-single-dataone.Rmd" class="external-link"><code>vignettes/use02_dataset-single-dataone.Rmd</code></a></small>
      <div class="d-none name"><code>use02_dataset-single-dataone.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette aims to showcase a use case using the 2 main functions
of <code>metajam</code> - <code>download_d1_data</code> and
<code>read_d1_files</code> to download one dataset from the DataOne data
repository.</p>
</div>
<div class="section level2">
<h2 id="note-on-data-url-provenance-when-using-download_d1_data-r">Note on data url provenance when using download_d1_data.R<a class="anchor" aria-label="anchor" href="#note-on-data-url-provenance-when-using-download_d1_data-r"></a>
</h2>
<p>There are two parameters required to run the download_d1_data.R
function in metajam. One is the data url for the dataset you’d like to
download.You can retrieve this by navigating to the data package of
interest, right-clicking on the download data button, and selecting Copy
Link Address.</p>
<p>For several DataOne member nodes (Arctic Data Center, Environmental
Data Initiative, and The Knowledge Network for Biocomplexity), metajam
users can retrieve the data url from either the ‘home’ site of the
member node or the from the DataOne instance of that same data package.
For example, if you wanted to download this dataset:</p>
<p>Kelsey J. Solomon, Rebecca J. Bixby, and Catherine M. Pringle. 2021.
Diatom Community Data from Coweeta LTER, 2005-2019. Environmental Data
Initiative. <a href="https://doi.org/10.6073/pasta/25e97f1eb9a8ed2aba8e12388f8dc3dc" class="external-link uri">https://doi.org/10.6073/pasta/25e97f1eb9a8ed2aba8e12388f8dc3dc</a>.</p>
<p>You have two options for where to obtain the data url.</p>
<ol style="list-style-type: decimal">
<li><p>You could navigate to this page on the Environmental Data
Initiative site (<a href="https://doi.org/10.6073/pasta/25e97f1eb9a8ed2aba8e12388f8dc3dc" class="external-link uri">https://doi.org/10.6073/pasta/25e97f1eb9a8ed2aba8e12388f8dc3dc</a>
) and right-click on the CWT_Hemlock_Diatom_Data.csv link to retrieve
this data url: <a href="https://portal.edirepository.org/nis/dataviewer?packageid=edi.858.1&amp;entityid=15ad768241d2eeed9f0ba159c2ab8fd5" class="external-link uri">https://portal.edirepository.org/nis/dataviewer?packageid=edi.858.1&amp;entityid=15ad768241d2eeed9f0ba159c2ab8fd5</a></p></li>
<li><p>You could fine this data package on the DataOne site (<a href="https://search.dataone.org/view/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fmetadata%2Feml%2Fedi%2F858%2F1" class="external-link uri">https://search.dataone.org/view/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fmetadata%2Feml%2Fedi%2F858%2F1</a>)
and right-click the Download button next to CWT_Hemlock_Diatom_Data.csv
to retrieve this data url:<a href="https://cn.dataone.org/cn/v2/resolve/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fdata%2Feml%2Fedi%2F858%2F1%2F15ad768241d2eeed9f0ba159c2ab8fd5" class="external-link uri">https://cn.dataone.org/cn/v2/resolve/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fdata%2Feml%2Fedi%2F858%2F1%2F15ad768241d2eeed9f0ba159c2ab8fd5</a></p></li>
</ol>
<p>Both will work with metajam! You will get the same output either
way.</p>
<p>We have not tested metajam’s compatibility with the home sites of all
DataOne member nodes. If you are using metajam to download data from a
member node other than ADC, EDI, or KNB we highly recommend retrieving
the data url from the DataOne instance of the package (example 2
above).</p>
</div>
<div class="section level2">
<h2 id="metadata-format-dictates-metajam-output">Metadata format dictates metajam output<a class="anchor" aria-label="anchor" href="#metadata-format-dictates-metajam-output"></a>
</h2>
<p>We include two examples, one downloading a dataset with metadata in
eml (ecological metadata format) and the other downloading a dataset
with metadata in ISO (International Organization for Standardization)
format.</p>
</div>
<div class="section level2">
<h2 id="example-1-eml">Example 1: eml<a class="anchor" aria-label="anchor" href="#example-1-eml"></a>
</h2>
<p>For the first example, we are using Diatom Community Data from
Coweeta LTER, 2005-2019: Kelsey J. Solomon, Rebecca J. Bixby, and
Catherine M. Pringle. Environmental Data Initiative. <a href="https://pasta.lternet.edu/package/metadata/eml/edi/858/1" class="external-link uri">https://pasta.lternet.edu/package/metadata/eml/edi/858/1</a>.</p>
</div>
<div class="section level2">
<h2 id="libraries-and-constants">Libraries and constants<a class="anchor" aria-label="anchor" href="#libraries-and-constants"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("NCEAS/metajam")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nceas.github.io/metajam/">metajam</a></span><span class="op">)</span>  </span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Directory to save the data set</span></span>
<span><span class="va">path_folder</span> <span class="op">&lt;-</span> <span class="st">"Data_coweeta"</span></span>
<span></span>
<span><span class="co"># URL to download the dataset from DataONE</span></span>
<span><span class="va">data_url</span> <span class="op">&lt;-</span> <span class="st">"https://cn.dataone.org/cn/v2/resolve/https%3A%2F%2Fpasta.lternet.edu%2Fpackage%2Fdata%2Feml%2Fedi%2F858%2F1%2F15ad768241d2eeed9f0ba159c2ab8fd5"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-the-dataset">Download the dataset<a class="anchor" aria-label="anchor" href="#download-the-dataset"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create the local directory to download the datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">path_folder</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the dataset and associated metdata </span></span>
<span><span class="va">data_folder</span> <span class="op">&lt;-</span> <span class="fu">metajam</span><span class="fu">::</span><span class="fu"><a href="../reference/download_d1_data.html">download_d1_data</a></span><span class="op">(</span><span class="va">data_url</span>, <span class="va">path_folder</span><span class="op">)</span></span></code></pre></div>
<p>At this point, you should have the data and the metadata downloaded
inside your main directory; <code>Data_coweeta</code> in this example.
<code>metajam</code> organize the files as follow:</p>
<ul>
<li>Each dataset is stored a sub-directory named after the package DOI
and the file name</li>
<li>Inside this sub-directory, you will find
<ul>
<li>the data: <code>my_data.csv</code>
</li>
<li>the raw EML with the naming convention <em>file name</em> +
<code>__full_metadata.xml</code>:
<code>my_data__full_metadata.xml</code>
</li>
<li>the package level metadata summary with the naming convention
<em>file name</em> + <code>__summary_metadata.csv</code>:
<code>my_data__summary_metadata.csv</code>
</li>
<li>If relevant, the attribute level metadata with the naming convention
<em>file name</em> + <code>__attribute_metadata.csv</code>:
<code>my_data__attribute_metadata.csv</code>
</li>
<li>If relevant, the factor level metadata with the naming convention
<em>file name</em> + <code>__attribute_factor_metadata.csv</code>:
my_data<code>__attribute_factor_metadata.csv</code>
</li>
</ul>
</li>
</ul>
<div class="figure" style="text-align: center">
<img src="../reference/figures/metajam_v1_folder.png" alt="Local file structure of a dataset downloaded by metajam" width="90%"><p class="caption">
Local file structure of a dataset downloaded by metajam
</p>
</div>
</div>
<div class="section level2">
<h2 id="read-the-data-and-metadata-in-your-r-environment">Read the data and metadata in your R environment<a class="anchor" aria-label="anchor" href="#read-the-data-and-metadata-in-your-r-environment"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read all the datasets and their associated metadata in as a named list</span></span>
<span><span class="va">coweeta_diatom</span> <span class="op">&lt;-</span> <span class="fu">metajam</span><span class="fu">::</span><span class="fu"><a href="../reference/read_d1_files.html">read_d1_files</a></span><span class="op">(</span><span class="va">data_folder</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="structure-of-the-named-list-object">Structure of the named list object<a class="anchor" aria-label="anchor" href="#structure-of-the-named-list-object"></a>
</h2>
<p>You have now loaded in your R environment one named list object that
contains the data <code>coweeta_diatom$data</code>, the general
(summary) metadata <code>coweeta_diatom$summary_metadata</code> - such
as title, creators, dates, locations - and the attribute level metadata
information <code>coweeta_diatom$attribute_metadata</code>, allowing
user to get more information, such as units and definitions of your
attributes.</p>
</div>
<div class="section level2">
<h2 id="example-2-iso">Example 2: iso<a class="anchor" aria-label="anchor" href="#example-2-iso"></a>
</h2>
<p>For the second example, we are using Marine bird survey observation
and density data from Northern Gulf of Alaska LTER cruises, 2018. Kathy
Kuletz, Daniel Cushing, and Elizabeth Labunski. Research Workspace. <a href="https://doi.org/10.24431/rw1k45w" class="external-link uri">https://doi.org/10.24431/rw1k45w</a></p>
</div>
<div class="section level2">
<h2 id="libraries-and-constants-1">Libraries and constants<a class="anchor" aria-label="anchor" href="#libraries-and-constants-1"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github("NCEAS/metajam")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nceas.github.io/metajam/">metajam</a></span><span class="op">)</span>  </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Directory to save the data set</span></span>
<span><span class="va">path_folder</span> <span class="op">&lt;-</span> <span class="st">"Data_alaska"</span></span>
<span></span>
<span><span class="co"># URL to download the dataset from DataONE</span></span>
<span><span class="va">data_url</span> <span class="op">&lt;-</span> <span class="st">"https://cn.dataone.org/cn/v2/resolve/4139539e-94e7-49cc-9c7a-5f879e438b16"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-the-dataset-1">Download the dataset<a class="anchor" aria-label="anchor" href="#download-the-dataset-1"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create the local directory to download the datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">path_folder</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download the dataset and associated metdata </span></span>
<span><span class="va">data_folder</span> <span class="op">&lt;-</span> <span class="fu">metajam</span><span class="fu">::</span><span class="fu"><a href="../reference/download_d1_data.html">download_d1_data</a></span><span class="op">(</span><span class="va">data_url</span>, <span class="va">path_folder</span><span class="op">)</span></span></code></pre></div>
<p>At this point, you should have the data and the metadata downloaded
inside your main directory; <code>Data_alaska</code> in this example.
<code>metajam</code> organize the files as follow:</p>
<ul>
<li>Each dataset is stored a sub-directory named after the package DOI
and the file name</li>
<li>Inside this sub-directory, you will find
<ul>
<li>the data: <code>my_data.csv</code>
</li>
<li>the raw EML with the naming convention <em>file name</em> +
<code>__full_metadata.xml</code>:
<code>my_data__full_metadata.xml</code>
</li>
<li>the package level metadata summary with the naming convention
<em>file name</em> + <code>__summary_metadata.csv</code>:
<code>my_data__summary_metadata.csv</code>
</li>
</ul>
</li>
</ul>
<div class="figure" style="text-align: center">
<img src="../reference/figures/metajam_v1_folder.png" alt="Local file structure of a dataset downloaded by metajam" width="90%"><p class="caption">
Local file structure of a dataset downloaded by metajam
</p>
</div>
</div>
<div class="section level2">
<h2 id="read-the-data-and-metadata-in-your-r-environment-1">Read the data and metadata in your R environment<a class="anchor" aria-label="anchor" href="#read-the-data-and-metadata-in-your-r-environment-1"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read all the datasets and their associated metadata in as a named list</span></span>
<span><span class="va">coweeta_diatom</span> <span class="op">&lt;-</span> <span class="fu">metajam</span><span class="fu">::</span><span class="fu"><a href="../reference/read_d1_files.html">read_d1_files</a></span><span class="op">(</span><span class="va">data_folder</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="structure-of-the-named-list-object-1">Structure of the named list object<a class="anchor" aria-label="anchor" href="#structure-of-the-named-list-object-1"></a>
</h2>
<p>You have now loaded in your R environment one named list object that
contains the data <code>coweeta_diatom$data</code>, the general
(summary) metadata <code>coweeta_diatom$summary_metadata</code> - such
as title, creators, dates, locations - and the attribute level metadata
information <code>coweeta_diatom$attribute_metadata</code>, allowing
user to get more information, such as units and definitions of your
attributes.</p>
<div class="figure" style="text-align: center">
<img src="../reference/figures/metajam_v1_named_list.png" alt="Structure of the named list object containing tabular metadata and data as loaded by metajam" width="90%"><p class="caption">
Structure of the named list object containing tabular metadata and data
as loaded by metajam
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julien Brun, Irene Steves, Mitchell Maier, Kristen Peach, Nicholas Lyon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
